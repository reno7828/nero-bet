{% extends 'core/base.html' %}
{% block content %}

<style>
    body { background-color: #F4F1EA !important; }

    .card-league {
        background: #FFFFFF;
        border: 2px solid #1A1A1A;
        border-radius: 20px;
        padding: 40px 20px;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        cursor: pointer;
        box-shadow: 4px 4px 0px #1A1A1A;
    }
    .card-league:hover {
        transform: translate(-2px, -2px);
        box-shadow: 8px 8px 0px #1B4FD8;
        border-color: #1B4FD8;
    }
    .match-card {
        background: #FFFFFF;
        border: 2px solid #1A1A1A;
        border-radius: 16px;
        padding: 25px;
        margin-bottom: 25px;
        box-shadow: 4px 4px 0px rgba(0,0,0,0.05);
    }
    .report-box {
        background: #F9F8F4;
        padding: 20px;
        border-radius: 12px;
        border: 1px solid #E5E2DC;
    }
    .team-logo {
        width: 45px;
        height: 45px;
        object-fit: contain;
        margin-bottom: 10px;
    }
</style>

{% if not active_league %}
    <div style="text-align:center; margin-top: 8vh;">
        <h1 style="font-family:'Instrument Serif'; font-size:4.5rem; letter-spacing: -1px;">Nero <em>Bet</em></h1>
        <p style="font-size:1.2rem; color:#444; margin-bottom:60px; font-weight: 300;">Sélectionnez une arène pour générer les analyses.</p>

        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; max-width: 1000px; margin: 0 auto;">
            {% for id, info in leagues.items %}
                <a href="?league={{ id }}" style="text-decoration:none; color:inherit;">
                    <div class="card-league">
                        <div style="font-size:3rem; margin-bottom:15px;">{{ info.flag }}</div>
                        <div style="font-family:'Instrument Serif'; font-size:1.8rem; font-weight: 500;">{{ info.name }}</div>
                        <div style="font-size:0.75rem; letter-spacing:2px; color:#888; text-transform: uppercase; margin-top: 5px;">{{ info.country }}</div>
                    </div>
                </a>
            {% endfor %}
        </div>
    </div>
{% else %}
    <div style="display: flex; gap: 40px; margin-top: 20px;">
        <div style="flex: 2;">
            <div style="display:flex; justify-content:space-between; align-items:flex-end; border-bottom:3px solid #1A1A1A; padding-bottom:15px; margin-bottom:40px;">
                <h1 style="font-family:'Instrument Serif'; font-size:3rem; margin:0;">Analyses <em>{{ active_league.name }}</em></h1>
                <a href="{% url 'dashboard' %}" style="text-decoration:none; color:#1B4FD8; font-weight: 700; font-size:0.9rem; text-transform: uppercase; letter-spacing: 1px;">
                    ← Changer de ligue
                </a>
            </div>

            {% for m in matches %}
                <div class="match-card">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <span style="background: #F4F1EA; border: 1px solid #1A1A1A; color: #1A1A1A; padding: 4px 14px; border-radius: 100px; font-size: 0.7rem; font-weight: 800; letter-spacing: 0.5px;">
                             {{ m.date }}
                        </span>
                    </div>

                    <div style="display:flex; justify-content:space-between; align-items:flex-start; margin-bottom:25px; text-align: center;">
                        <div style="flex:1; display: flex; flex-direction: column; align-items: center;">
                            {% if m.h_logo %}<img src="{{ m.h_logo }}" class="team-logo" alt="logo">{% endif %}
                            <div style="font-family:'Instrument Serif'; font-size:1.5rem; font-weight:600; line-height:1.1;">{{ m.h_name }}</div>
                            <div style="font-size:0.75rem; color:#888; margin-top: 5px;">Classement: <b>{{ m.h_rank }}</b></div>
                        </div>

                        <div style="padding-top: 20px;">
                            <div style="background:#1A1A1A; color:white; padding:6px 14px; border-radius:100px; font-weight:900; font-size:0.65rem; letter-spacing: 1px;">VS</div>
                        </div>

                        <div style="flex:1; display: flex; flex-direction: column; align-items: center;">
                            {% if m.a_logo %}<img src="{{ m.a_logo }}" class="team-logo" alt="logo">{% endif %}
                            <div style="font-family:'Instrument Serif'; font-size:1.5rem; font-weight:600; line-height:1.1;">{{ m.a_name }}</div>
                            <div style="font-size:0.75rem; color:#888; margin-top: 5px;">Classement: <b>{{ m.a_rank }}</b></div>
                        </div>
                    </div>

                    <div class="report-box">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom:15px;">
                            <span style="font-size:0.6rem; font-weight:800; color:#1B4FD8; letter-spacing:2px; text-transform: uppercase;">• Nero Intelligence Report</span>
                            <span style="font-size:0.7rem; font-weight:800; color:#0D7A4E;">{{ m.conf }}% CONFIDENCE</span>
                        </div>
                        <div style="font-size:1.05rem; line-height:1.6; color:#1A1A1A;">{{ m.report|linebreaksbr }}</div>

                        <div style="margin-top:18px; height:4px; background:#E5E2DC; border-radius:10px; overflow:hidden;">
                            <div style="width:{{ m.conf }}%; height:100%; background:#1B4FD8;"></div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>

        <div style="flex: 1;">
    <div style="background:#FFFFFF; border:3px solid #1A1A1A; border-radius:24px; padding:0; position:sticky; top:30px; box-shadow: 8px 8px 0px #1A1A1A; overflow: hidden;">

        <div style="background: #1A1A1A; color: white; padding: 25px; text-align: center;">
            <h2 style="font-family:'Instrument Serif'; font-size:2.4rem; margin:0; letter-spacing: 1px;">Golden <em>Ticket</em></h2>
            <p style="font-size: 0.75rem; color: #AAA; margin: 5px 0 0 0; text-transform: uppercase; letter-spacing: 2px;">Signaux Haute Confiance</p>
        </div>

        <div style="padding: 20px;">
            {% for b in best_bets %}
                <div style="position: relative; border-bottom: 1px dashed #D1CEC8; padding: 20px 0; display: flex; flex-direction: column; gap: 8px;">

                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="font-size: 0.65rem; font-weight: 800; color: #888; text-transform: uppercase;">{{ b.match }}</span>
                        <span style="background: #EDFAF4; color: #0D7A4E; padding: 3px 8px; border-radius: 5px; font-size: 0.65rem; font-weight: 900;">SAFE</span>
                    </div>

                    <div style="display: flex; justify-content: space-between; align-items: flex-end;">
                        <div>
                            <div style="font-size: 0.75rem; color: #1B4FD8; font-weight: 700; margin-bottom: 2px;">PRONO NERO :</div>
                            <div style="font-family: 'Instrument Serif'; font-size: 1.6rem; color: #1A1A1A; line-height: 1;">
                                {{ b.pick }}
                            </div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 1.4rem; font-weight: 900; color: #1B4FD8; line-height: 1;">
                                {{ b.conf }}%
                            </div>
                            <div style="font-size: 0.6rem; font-weight: 700; color: #AAA;">CONFIANCE</div>
                        </div>
                    </div>

                    <div style="position: absolute; left: -20px; top: 50%; transform: translateY(-50%); width: 4px; height: 30px; background: #1B4FD8; border-radius: 0 4px 4px 0;"></div>
                </div>
            {% empty %}
                <div style="text-align: center; padding: 40px 20px;">
                    <p style="font-style: italic; color: #999; font-size: 0.9rem;">Aucun signal VIP pour le moment. L'IA scanne les probabilités...</p>
                </div>
            {% endfor %}

            <div style="margin-top: 15px; text-align: center; padding: 10px;">
                <img src="https://upload.wikimedia.org/wikipedia/commons/d/d0/QR_code_for_mobile_English_Wikipedia.svg" style="width: 50px; opacity: 0.1; filter: grayscale(1);" alt="qr">
                <div style="font-size: 0.6rem; color: #CCC; margin-top: 10px; font-weight: 700; letter-spacing: 1px;">NERO-BET ALGORITHM V5.2.7</div>
            </div>
        </div>
    </div>
</div>
    </div>
{% endif %}

{% endblock %}